---
- name: Install {{ role_name }}
  unarchive:
    src: https://get.helm.sh/helm-v{{ helm_version }}-linux-amd64.tar.gz
    remote_src: true
    dest: /usr/local/bin/
    creates: /usr/local/bin/helm
    extra_opts: [--strip=1]

- name: Install Helmfile
  get_url:
    url: https://github.com/roboll/helmfile/releases/download/v{{ helmfile_version }}/helmfile_linux_amd64
    dest: /usr/local/bin/helmfile
    mode: a+x

- name: Install {{ role_name }} diff plugin
  shell: helm plugin install https://github.com/databus23/helm-diff --version master
  args:
    creates: "{{ lookup('env', 'HOME') }}/.local/share/helm/plugins/helm-diff/bin/diff"
